<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Fonts Showcase</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #4285F4;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 18px;
        }
        
        .font-counter {
            text-align: center;
            margin-bottom: 20px;
            font-size: 16px;
            color: #666;
            font-weight: 500;
        }
        
        .font-number {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            width: 30px;
            font-weight: bold;
            color: #999;
            margin-right: 10px;
            height: 24px; /* Match font name line height */
        }
        
        .search-container {
            margin-bottom: 30px;
            text-align: center;
        }
        
        #font-search {
            padding: 12px 20px;
            width: 100%;
            max-width: 500px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }
        
        #font-search:focus {
            border-color: #4285F4;
        }
        
        .font-categories {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }
        
        .category-btn {
            padding: 10px 20px;
            background-color: #fff;
            border: 2px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .category-btn:hover, .category-btn.active {
            background-color: #4285F4;
            color: white;
            border-color: #4285F4;
        }
        
        .fonts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .font-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .font-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }
        
        .font-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
            color: #4285F4;
            line-height: 1.2;
            display: flex;
            align-items: center;
            height: 24px; /* Match font number height */
        }
        
        .font-category {
            display: inline-block;
            padding: 4px 12px;
            background-color: #e8f0fe;
            color: #4285F4;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 15px;
        }
        
        .caps-badge {
            display: inline-block;
            padding: 4px 12px;
            background-color: #e8f5e9;
            color: #2E7D32;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
            border: 1px solid #2E7D32;
        }
        
        .font-preview {
            font-size: 24px;
            line-height: 1.4;
            color: #555;
            margin-bottom: 15px;
            min-height: 80px;
        }
        
        /* Fallback font indicator - purple color */
        .font-preview.fallback {
            color: #9C27B0; /* Distinctive purple */
            font-style: italic;
        }
        
        .font-preview.fallback::after {
            content: " [Fallback Font]";
            font-size: 14px;
            font-weight: bold;
            color: #9C27B0;
            font-style: normal;
        }
        
        .font-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }
        
        /* Ensure all cards have same height and buttons at bottom */
        .font-card {
            min-height: 220px;
        }
        
        .font-card-content {
            flex-grow: 1;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary {
            background-color: #4285F4;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #3367D6;
        }
        
        .btn-secondary {
            background-color: #f1f1f1;
            color: #333;
        }
        
        .btn-secondary:hover {
            background-color: #e1e1e1;
        }
        
        .preview-text-input {
            margin: 30px auto 20px;
            max-width: 1200px;
            padding: 0 20px;
        }
        
        #preview-text {
            padding: 12px 20px;
            width: 100%;
            max-width: 100%;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            box-sizing: border-box;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: #666;
        }
        
        .no-results {
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .fonts-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŽ¨ Google Fonts Showcase</h1>
            <p class="subtitle">Browse and preview beautiful Google Fonts</p>
            <div class="font-counter" id="font-counter">0 Fonts</div>
        </header>
        
        <div class="search-container">
            <input type="text" id="font-search" placeholder="ðŸ” Search fonts by name...">
        </div>
        
        <div class="font-categories">
            <button class="category-btn active" data-category="all">All Fonts</button>
            <button class="category-btn" data-category="caps">CAPS</button>
            <button class="category-btn" data-category="sans-serif">Sans Serif</button>
            <button class="category-btn" data-category="serif">Serif</button>
            <button class="category-btn" data-category="cursive">Cursive</button>
            <button class="category-btn" data-category="monospace">Monospace</button>
        </div>
        
        <div class="preview-text-input">
            <input type="text" id="preview-text" placeholder="Enter text to preview..." value="L'Ã©tÃ© brÃ»lant, l'hiver glacÃ© : voilÃ  deux saisons bien diffÃ©rentes ! Ã‰lÃ©phant, ÃŠtre, Ãˆveâ€¦ Ces mots franÃ§ais sont parfaits pour tester les polices. 123, 456â€¦ Et les chiffres ?">
        </div>
        
        <div class="fonts-grid" id="fonts-container">
            <div class="loading">Loading fonts...</div>
        </div>
    </div>
    
    <script>
        // Global variables
        let allFonts = [];
        let currentCategory = 'all';
        let previewText = "L'Ã©tÃ© brÃ»lant, l'hiver glacÃ© : voilÃ  deux saisons bien diffÃ©rentes ! Ã‰lÃ©phant, ÃŠtre, Ãˆveâ€¦ Ces mots franÃ§ais sont parfaits pour tester les polices. 123, 456â€¦ Et les chiffres ?";
        
        // DOM elements
        const fontsContainer = document.getElementById('fonts-container');
        const fontSearch = document.getElementById('font-search');
        const previewTextInput = document.getElementById('preview-text');
        const categoryButtons = document.querySelectorAll('.category-btn');
        
        // Initialize the app
        async function init() {
            try {
                // Load font data
                const response = await fetch('google-fonts.json');
                if (!response.ok) {
                    throw new Error('Failed to load font data');
                }
                
                allFonts = await response.json();
                
                // Convert font data to array format
                allFonts = Object.entries(allFonts).map(([name, data]) => ({
                    name,
                    category: data.category === 'handwriting' ? 'cursive' : data.category,
                    subsets: data.subsets || [],
                    variants: data.variants || {}
                }));
                
                // Filter fonts with Latin subset
                allFonts = allFonts.filter(font => font.subsets.includes('latin'));
                
                // Display fonts
                displayFonts();
                
                // Set up event listeners
                setupEventListeners();
                
            } catch (error) {
                console.error('Error loading fonts:', error);
                fontsContainer.innerHTML = `<div class="no-results">Error loading fonts. Please try again later.</div>`;
            }
        }
        
        function setupEventListeners() {
            // Search functionality
            fontSearch.addEventListener('input', () => {
                displayFonts();
            });
            
            // Preview text functionality
            previewTextInput.addEventListener('input', () => {
                previewText = previewTextInput.value;
                updateAllPreviews();
            });
            
            // Category buttons
            categoryButtons.forEach(button => {
                button.addEventListener('click', () => {
                    // Remove active class from all buttons
                    categoryButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Add active class to clicked button
                    button.classList.add('active');
                    
                    // Update current category
                    currentCategory = button.dataset.category;
                    
                    // Display fonts for selected category
                    displayFonts();
                });
            });
        }
        
        function displayFonts() {
            const searchTerm = fontSearch.value.toLowerCase();
            
            // Show loading state
            fontsContainer.innerHTML = `<div class="loading">Loading fonts...</div>`;
            
            // Filter fonts
            let filteredFonts = allFonts.filter(font => {
                // Filter by category
                if (currentCategory === 'caps') {
                    // Filter for truly all-caps fonts and SC/Caps fonts
                    // Complete list of 29 verified all-caps fonts (removed Swash Caps fonts)
                    const trulyAllCaps = [
                        'Aboreto', 'Alegreya SC', 'Alegreya Sans SC', 'Almendra SC',
                        'Amatic SC', 'Bowlby One SC', 'Bruno Ace SC',
                        'Carrois Gothic SC', 'Cormorant SC', 'Diplomata SC',
                        'Encode Sans SC', 'Graduate', 'Holtwood One SC',
                        'IM Fell DW Pica SC', 'IM Fell Double Pica SC', 'IM Fell English SC',
                        'IM Fell French Canon SC', 'IM Fell Great Primer SC', 'Marcellus SC',
                        'Mate SC', 'Monoton', 'Overlock SC', 'Patrick Hand SC', 'Playfair Display SC',
                        'Six Caps', 'Spectral SC', 'Shojumaru', 'Vollkorn SC', 'Ysabeau SC'
                    ];
                    
                    // Also include SC (Small Caps) and Caps fonts
                    const hasSCorCaps = /\b(SC|Caps)\b/i.test(font.name);
                    
                    // Exceptions: SC fonts and Swash Caps fonts that are NOT truly all-caps
                    const scExceptions = [
                        'Noto Sans SC', 'Noto Serif SC',
                        'Macondo Swash Caps', 'Oleo Script Swash Caps',
                        'Bilbo Swash Caps', 'Delius Swash Caps', 'Elsie Swash Caps'
                    ];
                    
                    const isSCFont = hasSCorCaps && !scExceptions.includes(font.name);
                    
                    return trulyAllCaps.includes(font.name) || isSCFont;
                } else if (currentCategory !== 'all' && font.category !== currentCategory) {
                    return false;
                }
                
                // Filter by search term
                if (searchTerm && !font.name.toLowerCase().includes(searchTerm)) {
                    return false;
                }
                
                return true;
            });
            
            // Update font counter
            const counterElement = document.getElementById('font-counter');
            const categoryLabel = currentCategory === 'caps' ? 'CAPS Fonts' :
                                 currentCategory === 'all' ? 'Fonts' : currentCategory + ' Fonts';
            counterElement.textContent = `${filteredFonts.length} ${categoryLabel}`;
            
            // Display fonts or no results message
            if (filteredFonts.length === 0) {
                fontsContainer.innerHTML = `<div class="no-results">No fonts found. Try a different search or category.</div>`;
                return;
            }
            
            // Generate font cards with numbering
            fontsContainer.innerHTML = filteredFonts.map((font, index) => createFontCard(font, index + 1)).join('');
            
            // Small delay to allow DOM to update before loading fonts
            setTimeout(() => {
                loadFontsForPreview(filteredFonts);
            }, 100);
        }
        
        function createFontCard(font, index) {
            // Create a unique class name for this font
            const fontClass = `font-${font.name.toLowerCase().replace(/\s+/g, '-')}`;
            const previewId = `preview-${font.name.toLowerCase().replace(/\s+/g, '-')}`;
            
            // Determine preview text based on category
            const displayText = currentCategory === 'all-caps' ? previewText.toUpperCase() : previewText;
            
            // Check if font is truly all-caps (for CAPS category)
            const isAllCaps = checkIfAllCaps(font.name);
            const capsBadge = isAllCaps ? '<div class="caps-badge">âœ… CAPS</div>' : '';
            
            return `
                <div class="font-card ${fontClass}">
                    <div class="font-card-content">
                        <div style="display: flex; align-items: center; min-height: 24px;">
                            <div class="font-number">${index}.</div>
                            <div class="font-name" style="font-family: '${font.name}', ${getFallbackFont(font.category)}">${font.name}</div>
                            ${capsBadge}
                        </div>
                        <div class="font-category">${font.category}</div>
                        <div class="font-preview" id="${previewId}" 
                             style="font-family: '${font.name}', ${getFallbackFont(font.category)}"
                             data-font-name="${font.name}"
                             data-fallback-font="${getFallbackFont(font.category)}">
                             ${displayText}
                        </div>
                    </div>
                    <div class="font-actions">
                        <button class="btn btn-primary" onclick="copyCSS('${font.name}', '${font.category}')">Copy CSS</button>
                        <button class="btn btn-secondary" onclick="viewOnGoogle('${font.name}')">View on Google</button>
                    </div>
                </div>
            `;
        }
        
        function checkIfAllCaps(fontName) {
            // Complete list of 29 verified all-caps fonts (removed Swash Caps fonts)
            const trulyAllCaps = [
                'Aboreto', 'Alegreya SC', 'Alegreya Sans SC', 'Almendra SC',
                'Amatic SC', 'Bowlby One SC', 'Bruno Ace SC',
                'Carrois Gothic SC', 'Cormorant SC', 'Diplomata SC',
                'Encode Sans SC', 'Graduate', 'Holtwood One SC',
                'IM Fell DW Pica SC', 'IM Fell Double Pica SC', 'IM Fell English SC',
                'IM Fell French Canon SC', 'IM Fell Great Primer SC', 'Marcellus SC',
                'Mate SC', 'Monoton', 'Overlock SC', 'Patrick Hand SC', 'Playfair Display SC',
                'Six Caps', 'Spectral SC', 'Shojumaru', 'Vollkorn SC', 'Ysabeau SC'
            ];
            
            return trulyAllCaps.includes(fontName);
        }
        
        function getFallbackFont(category) {
            switch (category) {
                case 'sans-serif': return 'sans-serif';
                case 'serif': return 'serif';
                case 'cursive': return 'cursive';
                case 'monospace': return 'monospace';
                default: return 'sans-serif';
            }
        }
        
        function loadFontsForPreview(fonts) {
            // Load actual Google Fonts for true previews
            const head = document.head;
            
            // Remove any previously loaded font links
            const existingLinks = head.querySelectorAll('link[href*="fonts.googleapis.com"]');
            existingLinks.forEach(link => head.removeChild(link));
            
            // Load ALL visible fonts (no limit)
            const fontsToLoad = fonts;
            
            // Log for debugging
            console.log("Polices chargÃ©es :", fontsToLoad.map(f => f.name));
            console.log("Nombre total :", fontsToLoad.length);
            
            // Load each font with multiple weights for better variant support
            fontsToLoad.forEach(font => {
                const fontName = font.name.replace(/ /g, '+');
                const fontLink = document.createElement('link');
                // Load regular (400) and bold (700) weights for better variant support
                fontLink.href = `https://fonts.googleapis.com/css2?family=${fontName}:wght@400;700&display=swap`;
                fontLink.rel = 'stylesheet';
                head.appendChild(fontLink);
            });
            
            // Force normal display for all loaded fonts
            fontsToLoad.forEach(font => {
                const previewId = `preview-${font.name.toLowerCase().replace(/\s+/g, '-')}`;
                const previewElement = document.getElementById(previewId);
                if (previewElement) {
                    previewElement.classList.remove('fallback');
                }
            });
        }
        
        function checkFontLoading(fontName) {
            const previewId = `preview-${fontName.toLowerCase().replace(/\s+/g, '-')}`;
            const previewElement = document.getElementById(previewId);
            
            if (!previewElement) return;
            
            // Create a test element with the expected font
            const testElement = document.createElement('span');
            testElement.style.fontFamily = `'${fontName}', ${previewElement.dataset.fallbackFont}`;
            testElement.style.fontSize = '40px';
            testElement.style.position = 'absolute';
            testElement.style.visibility = 'hidden';
            testElement.textContent = 'ABCabc123';
            document.body.appendChild(testElement);
            
            // Create a reference element with the fallback font
            const fallbackElement = document.createElement('span');
            fallbackElement.style.fontFamily = previewElement.dataset.fallbackFont;
            fallbackElement.style.fontSize = '40px';
            fallbackElement.style.position = 'absolute';
            fallbackElement.style.visibility = 'hidden';
            fallbackElement.textContent = 'ABCabc123';
            document.body.appendChild(fallbackElement);
            
            // Measure the width of both elements
            const testWidth = testElement.getBoundingClientRect().width;
            const fallbackWidth = fallbackElement.getBoundingClientRect().width;
            
            // Clean up
            document.body.removeChild(testElement);
            document.body.removeChild(fallbackElement);
            
            // If widths are significantly different, the font is loaded
            const isFontLoaded = Math.abs(testWidth - fallbackWidth) > 5; // Threshold of 5px difference
            
            if (isFontLoaded) {
                previewElement.classList.remove('fallback');
            } else {
                previewElement.classList.add('fallback');
            }
        }
        
        function updateAllPreviews() {
            const fontCards = document.querySelectorAll('.font-card');
            fontCards.forEach(card => {
                const previewElement = card.querySelector('.font-preview');
                if (previewElement) {
                    const displayText = currentCategory === 'all-caps' ? previewText.toUpperCase() : previewText;
                    previewElement.textContent = displayText;
                }
            });
        }
        
        function copyCSS(fontName, category) {
            const fontNameLower = fontName.toLowerCase().replace(/ /g, '');
            const fontNameKebab = fontName.toLowerCase().replace(/ /g, '-');
            
            const css = `
@font-face {
    font-family: '${fontName}';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url(https://fonts.gstatic.com/s/${fontNameLower}/latest/400.woff2) format('woff2');
}

@font-face {
    font-family: '${fontName}';
    font-style: normal;
    font-weight: 700;
    font-display: swap;
    src: url(https://fonts.gstatic.com/s/${fontNameLower}/latest/700.woff2) format('woff2');
}

:root {
    --font-${fontNameKebab}: "${fontName}", ${category};
}

.font-${fontNameKebab}-regular {
    font-family: var(--font-${fontNameKebab});
    font-weight: 400;
    font-style: normal;
}

.font-${fontNameKebab}-bold {
    font-family: var(--font-${fontNameKebab});
    font-weight: 700;
    font-style: normal;
}
            `;
            
            navigator.clipboard.writeText(css).then(() => {
                alert(`CSS for ${fontName} (with multiple weights) copied to clipboard!`);
            }).catch(err => {
                console.error('Failed to copy CSS:', err);
                alert('Failed to copy CSS. Please try again.');
            });
        }
        
        function viewOnGoogle(fontName) {
            window.open(`https://fonts.google.com/specimen/${fontName.replace(/ /g, '+')}`, '_blank');
        }
        
// Start the app
        init();
    </script>
</body>
</html>